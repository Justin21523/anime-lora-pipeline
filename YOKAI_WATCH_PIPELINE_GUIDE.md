# Yokai Watch è‡ªå‹•åŒ–è¨“ç·´æµç¨‹æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

é€™å€‹è‡ªå‹•åŒ–æµç¨‹æœƒè™•ç†æ‰€æœ‰ Yokai Watch çš„ framesï¼ŒåŸ·è¡Œå®Œæ•´çš„ LoRA è¨“ç·´æµç¨‹ï¼š

1. **åˆ†å±¤åˆ†å‰²** - å°‡ frames åˆ†é›¢æˆè§’è‰²å±¤å’ŒèƒŒæ™¯å±¤
2. **è§’è‰²èšé¡** - è‡ªå‹•è­˜åˆ¥ä¸¦åˆ†çµ„è§’è‰²
3. **AI åˆ†æ** - åˆ†æè§’è‰²ç‰¹å¾µå’Œé¢¨æ ¼
4. **æ¨™è¨»ç”Ÿæˆ** - è‡ªå‹•ç”Ÿæˆè¨“ç·´æ¨™è¨»
5. **LoRA è¨“ç·´** - è¨“ç·´æ¯å€‹è§’è‰²çš„ LoRA æ¨¡å‹
6. **æ¸¬è©¦è©•ä¼°** - ç”Ÿæˆæ¸¬è©¦åœ–ç‰‡ä¸¦è©•ä¼°å“è³ª

## ğŸ¯ è¨­è¨ˆç‰¹é»

### ç©ºé–“æ•ˆç‡è¨­è¨ˆ
- **æ‰¹æ¬¡è™•ç†**: ä¸€æ¬¡è™•ç† 10 å€‹ episodesï¼Œè™•ç†å®Œå³æ¸…ç†è‡¨æ™‚æ–‡ä»¶
- **æ¼¸é€²å¼åˆä½µ**: æ¯æ‰¹æ¬¡çš„è§’è‰²èšé¡æœƒåˆä½µåˆ°æœ€çµ‚è¼¸å‡º
- **æœ€å°è‡¨æ™‚ç©ºé–“**: åªä¿ç•™ç•¶å‰æ‰¹æ¬¡çš„åˆ†å±¤æ–‡ä»¶ï¼Œåœ¨ `/tmp` ç›®éŒ„è™•ç†
- **æœ€çµ‚ä¿ç•™**: åªä¿ç•™è§’è‰²èšé¡ã€è¨“ç·´æ•¸æ“šå’Œæ¨¡å‹æ–‡ä»¶

### è‡ªå‹•åŒ–è¨­è¨ˆ
- **ç„¡äººå€¼å®ˆ**: å¯ä»¥é€£çºŒé‹è¡Œè™•ç†æ‰€æœ‰è§’è‰²
- **éŒ¯èª¤è™•ç†**: å–®å€‹è§’è‰²å¤±æ•—ä¸æœƒå½±éŸ¿å…¶ä»–è§’è‰²
- **é€²åº¦è¨˜éŒ„**: è©³ç´°çš„æ—¥èªŒå’Œ JSON çµæœæ–‡ä»¶
- **æ–·é»çºŒå‚³**: å¯ä»¥è·³éå·²å®Œæˆçš„éšæ®µ

## ğŸ“Š æ•¸æ“šè¦æ¨¡

**ç•¶å‰æ•¸æ“š**:
- ğŸ“ Episodes: 214 å€‹å­£åº¦è³‡æ–™å¤¾
- ğŸ–¼ï¸ ç¸½ Frames: 1,042,599 å¼µ
- ğŸ“ æ•¸æ“šä½ç½®: `/home/b0979/yokai_input_fast`

**é ä¼°è¼¸å‡º**:
- ğŸ‘¥ è§’è‰²æ•¸é‡: é ä¼° 50-100+ å€‹è§’è‰² (min_cluster_size=25)
- ğŸ’¾ æ¯å€‹è§’è‰²: 25-500+ å¼µè¨“ç·´åœ–ç‰‡
- ğŸ“ æ¨¡å‹æ•¸é‡: æ¯å€‹è§’è‰²ç”¢ç”Ÿ 1 å€‹ LoRA æ¨¡å‹

## ğŸš€ ä½¿ç”¨æ–¹å¼

### æ–¹æ¡ˆ 1: å¿«é€Ÿæ¸¬è©¦ï¼ˆæ¨è–¦å…ˆåŸ·è¡Œï¼‰

æ¸¬è©¦åŸºæœ¬æµç¨‹æ˜¯å¦æ­£å¸¸ï¼Œåªè™•ç† 5 å€‹ episodes å’Œ 2 å€‹è§’è‰²ï¼š

\`\`\`bash
cd /mnt/c/AI_LLM_projects/inazuma-eleven-lora
./scripts/batch/test_yokai_pipeline.sh
\`\`\`

**é è¨ˆæ™‚é–“**: ç´„ 1-2 å°æ™‚
**è¼¸å‡ºä½ç½®**: `/mnt/c/AI_LLM_projects/ai_warehouse/outputs/yokai-watch/quick_test`

### æ–¹æ¡ˆ 2: å®Œæ•´æµç¨‹ï¼ˆéå¤œåŸ·è¡Œï¼‰

è™•ç†æ‰€æœ‰æ•¸æ“šï¼š

\`\`\`bash
# 1. å•Ÿå‹• tmux sessionï¼ˆé‡è¦ï¼é¿å…æ–·ç·šï¼‰
tmux new -s yokai_training

# 2. é€²å…¥é …ç›®ç›®éŒ„
cd /mnt/c/AI_LLM_projects/inazuma-eleven-lora

# 3. åŸ·è¡Œå®Œæ•´æµç¨‹
./scripts/batch/run_yokai_full_pipeline.sh

# 4. åˆ†é›¢ tmux (Ctrl+B ç„¶å¾ŒæŒ‰ D)
# é€™æ¨£å¯ä»¥é—œé–‰çµ‚ç«¯ï¼Œæµç¨‹ç¹¼çºŒé‹è¡Œ
\`\`\`

**é è¨ˆæ™‚é–“**:
- åˆ†å±¤åˆ†å‰²: ~30-50 å°æ™‚ (1M+ frames)
- è§’è‰²èšé¡: ~5-10 å°æ™‚
- æ¯å€‹è§’è‰²è¨“ç·´: ~1-2 å°æ™‚
- **ç¸½è¨ˆ**: ç´„ 2-3 å¤©

### æ–¹æ¡ˆ 3: è‡ªè¨‚åƒæ•¸

\`\`\`bash
# åªè™•ç†å‰ 50 å€‹ episodes
./scripts/batch/run_yokai_full_pipeline.sh --total-episodes 50

# åªè¨“ç·´å‰ 10 å€‹è§’è‰²
./scripts/batch/run_yokai_full_pipeline.sh --max-characters 10

# çµ„åˆä½¿ç”¨
./scripts/batch/run_yokai_full_pipeline.sh \\
    --total-episodes 50 \\
    --max-characters 10 \\
    --episodes-per-batch 5 \\
    --min-cluster-size 30
\`\`\`

**åƒæ•¸èªªæ˜**:
- `--total-episodes N`: åªè™•ç†å‰ N å€‹ episodesï¼ˆé è¨­ï¼šå…¨éƒ¨ï¼‰
- `--max-characters N`: åªè¨“ç·´å‰ N å€‹è§’è‰²ï¼ˆé è¨­ï¼šå…¨éƒ¨ï¼‰
- `--episodes-per-batch N`: æ¯æ‰¹æ¬¡è™•ç† N å€‹ episodesï¼ˆé è¨­ï¼š10ï¼‰
- `--min-cluster-size N`: è§’è‰²æœ€å°åœ–ç‰‡æ•¸é‡ï¼ˆé è¨­ï¼š25ï¼‰

## ğŸ“‚ è¼¸å‡ºçµæ§‹

\`\`\`
/mnt/c/AI_LLM_projects/ai_warehouse/

â”œâ”€â”€ training_data/yokai-watch/
â”‚   â”œâ”€â”€ cluster_000/                    # è§’è‰² 0 çš„è¨“ç·´æ•¸æ“š
â”‚   â”‚   â”œâ”€â”€ *.png                       # è§’è‰²åœ–ç‰‡
â”‚   â”‚   â””â”€â”€ *.txt                       # å°æ‡‰æ¨™è¨»
â”‚   â”œâ”€â”€ cluster_001/                    # è§’è‰² 1
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ models/lora/yokai-watch/
â”‚   â”œâ”€â”€ cluster_000/
â”‚   â”‚   â”œâ”€â”€ cluster_000.safetensors     # æœ€çµ‚æ¨¡å‹
â”‚   â”‚   â””â”€â”€ cluster_000-epoch*.safetensors  # æª¢æŸ¥é»
â”‚   â”œâ”€â”€ cluster_001/
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ outputs/yokai-watch/
    â”œâ”€â”€ pipeline/                       # æµç¨‹è¼¸å‡º
    â”‚   â”œâ”€â”€ pipeline_log_*.txt         # è©³ç´°æ—¥èªŒ
    â”‚   â”œâ”€â”€ pipeline_results.json      # çµæœæ‘˜è¦
    â”‚   â””â”€â”€ full_pipeline.log          # å®Œæ•´è¼¸å‡º
    â”‚
    â”œâ”€â”€ cluster_000/
    â”‚   â”œâ”€â”€ ai_analysis/               # AI åˆ†æçµæœ
    â”‚   â””â”€â”€ lora_tests/                # æ¸¬è©¦ç”Ÿæˆåœ–ç‰‡
    â””â”€â”€ ...
\`\`\`

## ğŸ” ç›£æ§é€²åº¦

### æª¢æŸ¥ tmux session

\`\`\`bash
# åˆ—å‡ºæ‰€æœ‰ sessions
tmux ls

# é‡æ–°é€£æ¥åˆ° session
tmux attach -t yokai_training

# åœ¨ tmux å…§éƒ¨åˆ‡æ›è¦–çª—
Ctrl+B ç„¶å¾ŒæŒ‰ [    # é€²å…¥æ»¾å‹•æ¨¡å¼ï¼Œå¯ä»¥ä¸Šä¸‹æŸ¥çœ‹
Q                    # é€€å‡ºæ»¾å‹•æ¨¡å¼
\`\`\`

### æŸ¥çœ‹å¯¦æ™‚æ—¥èªŒ

\`\`\`bash
# æ–¹æ³• 1: æŸ¥çœ‹æœ€æ–°çš„æµç¨‹æ—¥èªŒ
tail -f /mnt/c/AI_LLM_projects/ai_warehouse/outputs/yokai-watch/*/full_pipeline.log

# æ–¹æ³• 2: æŸ¥çœ‹è©³ç´°æ—¥èªŒ
tail -f /mnt/c/AI_LLM_projects/ai_warehouse/outputs/yokai-watch/*/pipeline_log_*.txt
\`\`\`

### æŸ¥çœ‹ GPU ä½¿ç”¨æƒ…æ³

\`\`\`bash
# å¯¦æ™‚ç›£æ§
watch -n 1 nvidia-smi

# æˆ–è€…ä¸€æ¬¡æ€§æŸ¥çœ‹
nvidia-smi
\`\`\`

### æŸ¥çœ‹é€²åº¦æ‘˜è¦

\`\`\`bash
# æŸ¥çœ‹ JSON çµæœæ–‡ä»¶
cat /mnt/c/AI_LLM_projects/ai_warehouse/outputs/yokai-watch/*/pipeline_results.json | jq '.'

# å¿«é€Ÿçµ±è¨ˆ
cat /mnt/c/AI_LLM_projects/ai_warehouse/outputs/yokai-watch/*/pipeline_results.json | jq '.processed'
\`\`\`

## âš ï¸ æ³¨æ„äº‹é …

### ç©ºé–“éœ€æ±‚

- **è‡¨æ™‚ç©ºé–“** (`/tmp`): ç´„ 50-100 GBï¼ˆæ‰¹æ¬¡è™•ç†æœƒè‡ªå‹•æ¸…ç†ï¼‰
- **æœ€çµ‚è¼¸å‡º**:
  - è¨“ç·´æ•¸æ“š: ç´„ 20-50 GBï¼ˆè§’è‰²åœ–ç‰‡ + æ¨™è¨»ï¼‰
  - æ¨¡å‹æ–‡ä»¶: ç´„ 5-10 GBï¼ˆæ¯å€‹æ¨¡å‹ ~50-100 MBï¼‰
  - æ¸¬è©¦åœ–ç‰‡: ç´„ 5-10 GB

### æ™‚é–“å®‰æ’

å»ºè­°åœ¨é€±æœ«æˆ–éå¤œåŸ·è¡Œå®Œæ•´æµç¨‹ï¼š
- **é€±äº”æ™šä¸Šå•Ÿå‹•** â†’ é€±ä¸€æ—©ä¸Šå®Œæˆ
- **ä½¿ç”¨ tmux** ç¢ºä¿å³ä½¿æ–·ç·šä¹Ÿèƒ½ç¹¼çºŒåŸ·è¡Œ

### éŒ¯èª¤è™•ç†

æµç¨‹è¨­è¨ˆç‚ºå®¹éŒ¯ï¼š
- å–®å€‹ episode åˆ†å‰²å¤±æ•— â†’ è¨˜éŒ„ä¸¦ç¹¼çºŒ
- å–®å€‹è§’è‰²è¨“ç·´å¤±æ•— â†’ è¨˜éŒ„ä¸¦è™•ç†ä¸‹ä¸€å€‹
- å¯ä»¥é‡æ–°åŸ·è¡Œï¼Œæœƒè·³éå·²å®Œæˆçš„èšé¡éšæ®µ

## ğŸ”§ é€²éšé¸é …

### åªåŸ·è¡Œç‰¹å®šéšæ®µ

å¦‚æœä½ å·²ç¶“æœ‰èšé¡çµæœï¼Œå¯ä»¥ç›´æ¥è¨“ç·´ï¼š

\`\`\`python
# ç·¨è¼¯è…³æœ¬æ·»åŠ åƒæ•¸
python3 scripts/batch/yokai_watch_space_efficient.py \\
    --input-frames /home/b0979/yokai_input_fast \\
    --output-dir /path/to/output \\
    --skip-segmentation \\
    --skip-clustering \\
    --device cuda
\`\`\`

### èª¿æ•´è¨“ç·´åƒæ•¸

ç·¨è¼¯ `scripts/batch/yokai_watch_space_efficient.py`ï¼Œæ‰¾åˆ° `train_character_lora` å‡½æ•¸ï¼Œå¯ä»¥ä¿®æ”¹ï¼š
- `--max_train_steps`: è¨“ç·´æ­¥æ•¸ï¼ˆé è¨­ 2000ï¼‰
- `--learning_rate`: å­¸ç¿’ç‡ï¼ˆé è¨­ 1e-4ï¼‰
- `--network_dim`: LoRA ç¶­åº¦ï¼ˆé è¨­ 32ï¼‰
- `--train_batch_size`: æ‰¹æ¬¡å¤§å°ï¼ˆé è¨­ 2ï¼‰

## ğŸ“ˆ é æœŸçµæœ

åŸ·è¡Œå®Œæˆå¾Œï¼Œä½ å°‡å¾—åˆ°ï¼š

1. **50-100+ å€‹è§’è‰²çš„ LoRA æ¨¡å‹**
   - æ¯å€‹æ¨¡å‹å¯ä»¥ç”Ÿæˆè©²è§’è‰²çš„åœ–ç‰‡
   - ä¸åŒè¨“ç·´éšæ®µçš„æª¢æŸ¥é»å¯ä»¥æ¯”è¼ƒ

2. **å®Œæ•´çš„è¨“ç·´æ•¸æ“šé›†**
   - è‡ªå‹•æ¨™è¨»çš„è§’è‰²åœ–ç‰‡
   - å¯ç”¨æ–¼å¾ŒçºŒå¾®èª¿æˆ–å…¶ä»–è¨“ç·´

3. **æ¸¬è©¦ç”Ÿæˆçš„åœ–ç‰‡**
   - æ¯å€‹è§’è‰²çš„æ¸¬è©¦æ¨£æœ¬
   - å¯ä»¥ç›´è§€è©•ä¼°æ¨¡å‹å“è³ª

4. **è©³ç´°çš„åˆ†æå ±å‘Š**
   - AI åˆ†æçš„è§’è‰²ç‰¹å¾µ
   - è¨“ç·´éç¨‹çš„æ—¥èªŒå’Œçµ±è¨ˆ

## ğŸ‰ é–‹å§‹åŸ·è¡Œ

å»ºè­°åŸ·è¡Œé †åºï¼š

\`\`\`bash
# 1. å…ˆåŸ·è¡Œå¿«é€Ÿæ¸¬è©¦ï¼ˆ1-2 å°æ™‚ï¼‰
./scripts/batch/test_yokai_pipeline.sh

# 2. æª¢æŸ¥æ¸¬è©¦çµæœ
ls -lh /mnt/c/AI_LLM_projects/ai_warehouse/outputs/yokai-watch/quick_test/

# 3. å¦‚æœæ¸¬è©¦æˆåŠŸï¼Œå•Ÿå‹•å®Œæ•´æµç¨‹
tmux new -s yokai_training
./scripts/batch/run_yokai_full_pipeline.sh

# 4. åˆ†é›¢ tmuxï¼ˆCtrl+B, Dï¼‰ç„¶å¾Œå»ä¼‘æ¯ :)
\`\`\`

## ğŸ“ å•é¡Œæ’æŸ¥

### è¨˜æ†¶é«”ä¸è¶³
- é™ä½ `--episodes-per-batch`ï¼ˆä¾‹å¦‚æ”¹ç‚º 5ï¼‰
- ç¢ºä¿ `/tmp` æœ‰è¶³å¤ ç©ºé–“

### GPU éŒ¯èª¤
- æª¢æŸ¥ `nvidia-smi` ç¢ºèª GPU å¯ç”¨
- å˜—è©¦æ·»åŠ  `--device cpu` ä½¿ç”¨ CPUï¼ˆæœƒå¾ˆæ…¢ï¼‰

### è¨“ç·´å¤±æ•—
- æª¢æŸ¥ `pipeline_log_*.txt` æŸ¥çœ‹è©³ç´°éŒ¯èª¤
- æŸäº›è§’è‰²åœ–ç‰‡å¤ªå°‘æœƒè‡ªå‹•è·³éï¼ˆ< min_cluster_sizeï¼‰

---

**ç¥è¨“ç·´é †åˆ©ï¼æ—©ä¸Šè¦‹ï¼** ğŸŒ…
